<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简化JSON编辑器测试</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components/json-formatter.css">
    <style>
        body {
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            text-align: center;
        }
        .test-header h1 {
            margin: 0;
            font-size: 1.5rem;
        }
        .test-header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>JSON编辑器 - 简化版</h1>
            <p>仅保留核心功能：格式化、压缩、复制、清空</p>
        </div>
        
        <!-- JSON解析工具 -->
        <div id="json-parser" class="tool-panel">
            <div class="tool-content single-layout">
                <div class="json-editor-section">
                    <!-- 工具栏 -->
                    <div class="json-toolbar">
                        <div class="toolbar-controls">
                            <button id="formatJson" class="btn-small primary">
                                <span class="btn-icon">✨</span>格式化
                            </button>
                            <button id="compressJson" class="btn-small secondary">
                                <span class="btn-icon">📦</span>压缩
                            </button>
                            <button id="copyJsonResult" class="btn-small secondary">
                                <span class="btn-icon">📋</span>复制
                            </button>
                            <button id="clearJson" class="btn-small secondary">
                                <span class="btn-icon">🗑️</span>清空
                            </button>
                        </div>
                        <!-- 状态信息 -->
                        <div class="status-info">
                            <span id="jsonStatus" class="status-text">准备就绪</span>
                            <span id="jsonStats" class="stats-text"></span>
                        </div>
                    </div>
                    
                    <!-- 编辑器和显示区域 -->
                    <div class="json-editor-container">
                        <!-- 文本编辑器 -->
                        <textarea id="jsonInput" class="json-editor" placeholder="请输入JSON数据..." rows="35">{"app":"BIXIN","merchantId":"P_M_200007","tradeType":"P_T_200744","tradeNo":"01000000729967175135448573100000","tradeSeq":"02000000729967175135448573100001","tradeSystem":"TRANSACTION","tradeBatNo":"06000000729967175135448573100002","tradeTime":"2025-07-01 00:00:00","bizNo":"b74ca98f07ab469092bbd9956e56a4b1","sceneCode":"DEFAULT","globalTime":"2025-07-01 15:21:26","fundTime":"2025-07-01 15:21:25","detailList":[{"uid":99998888,"accountType":"","asset":"SYSTEM_ASSET","assetId":"","assetDetailId":"","amount":0.99,"totalValue":0.99,"changeType":"O","reduceStrategy":"DEFAULT","fundType":0,"creditId":"","origin":"","freezeBalNo":"","journalType":"OUT_ACTIVITY","outId":"07000000729967175135448573100004","origOutId":"","ext":"{\"payId\":\"02000000729967175135448573100001\"}","checkExt":"{\"transTotalValue\":0.9900,\"actionTotalValue\":0.9900,\"payId\":\"02000000729967175135448573100001\"}","memo":""},{"uid":1835711051600002,"accountType":"","asset":"GIFT","assetId":"36151","assetDetailId":"","amount":1.00,"totalValue":0.99,"changeType":"I","reduceStrategy":"","fundType":0,"creditId":"","origin":"","freezeBalNo":"","journalType":"IN_ACTIVITY","outId":"07000000729967175135448573200000","origOutId":"","ext":"{\"magic_trade_no\":\"73ef149432ae4209aa016efe2576c38c\",\"expireTime\":1752595199999,\"payId\":\"02000000729967175135448573100001\",\"sceneType\":\"2\"}","checkExt":"{\"transTotalValue\":0.9900,\"actionTotalValue\":0.9900,\"payId\":\"02000000729967175135448573100001\"}","memo":"11周年普通奖池"}]}</textarea>
                        
                        <!-- 格式化显示器 -->
                        <div id="jsonOutput" class="json-formatted-display collapsible-output" data-placeholder="格式化后将在这里显示可折叠的JSON结构..."></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/core/base-tool.js"></script>
    <script src="js/core/collapsible-formatter.js"></script>
    <script src="js/tools/json-tool.js"></script>
    <script>
        // 初始化JSON工具
        const jsonTool = new JSONTool();
        jsonTool.init();

        // 页面加载完成后的初始化
        window.onload = function() {
            console.log('简化JSON编辑器测试页面加载完成');
            jsonTool.updateStatus('准备就绪', 'info');
            
            console.log('功能测试：');
            console.log('1. 点击格式化 - 切换到可折叠显示模式');
            console.log('2. 再次点击格式化 - 切换回文本模式');
            console.log('3. 点击压缩 - 压缩JSON并保持在文本模式');
            console.log('4. 可以直接点击折叠节点的+/-进行操作');
        };
    </script>
</body>
</html>